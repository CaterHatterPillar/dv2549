\documentclass[fleqn,10pt]{SelfArx} % Document font size and equations flushed left

\setlength{\columnsep}{0.55cm} % Distance between the two columns of text
\setlength{\fboxrule}{0.75pt} % Width of the border around the abstract

\definecolor{color1}{RGB}{0,0,0} % Color of the article title and sections
\definecolor{color2}{RGB}{0,20,20} % Color of the boxes behind the abstract and headings

\newlength{\tocsep} 
\setlength\tocsep{1.5pc} % Sets the indentation of the sections in the table of contents
\setcounter{tocdepth}{3} % Show only three levels in the table of contents section: sections, subsections and subsubsections

\usepackage{float}
\usepackage{mdwlist}
\usepackage{caption}
\usepackage{verbatim}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

% Consider inserting:
%\usepackage{kpfonts}

\JournalInfo{\today} % Journal information
\Archive{First~Draft} % Additional notes (e.g. copyright, DOI, review/research article)
\PaperTitle{Emulated~GPGPU~Kernels\\A~Study~into~Performance} % Article title
\Authors{Eric~Nilsson} % Authors
\affiliation{EricNNilsson@gmail.com}
%\affiliation{*\textbf{Corresponding author}: john@smith.com} % Corresponding author
\Keywords{GPGPU, GPU, Performance, Emulation, Simulation} % Keywords - if you don't want any simply remove all the text between the curly brackets
\newcommand{\keywordname}{Keywords} % Defines the keywords heading name

% ABSTRACT
\Abstract{
\ldots \\
As such, the hypothesis suggested in this proposal may be summarized as follows:
\quote{\textit{The performance of an emulated GPGPU-kernel on a CPU may have it’s performance substantially improved in exchange for some computational precision.}}
% Background	(what)
%	Vilket sammanhang utgör studiens bakgrund?
% Challenge		(why)
%	Vilka utmaningar omfattar studien?
% Approach		(how)
%	Vilken ansats tillämpas i studien?
% Results 		(what)
%	Vilka resultat gav studien?
}

\begin{document}
\flushbottom % Makes all text pages the same height
\maketitle % Print the title and abstract box

\noindent
\textit{"Inspirational quote."}
\begin{center}
- Someone smart.
\end{center}

\tableofcontents % Print the contents section
\thispagestyle{empty} % Removes page numbering from the first page

% INTRODUCTION
\section*{Introduction} % The \section*{} command stops section numbering
\addcontentsline{toc}{section}{\hspace*{-\tocsep}Introduction} % Adds this section to the table of contents with negative horizontal space equal to the indent for the numbered sections
\label{sec:introduction}
% Background and Challenge
%	Vilket sammanhang utgör studiens bakgrund?
%	Vilka utmaningar omfattar studien?
When developing \textit{GPU}-kernels relatively small changes may induce large deviations in performance, due to massively parallelized instruction sets and architectural differences in-
between on-chip hardware. Therefore, it may be desirable for the developer to be able to view the data he or she is modifying on the graphics card - a possibility often limited in terms of \textit{GPGPU}-
technologies.\\
\\
% Approach and Result
%	Vilken ansats tillämpas i studien?
%	Vilka resultat gav studien?
The increased utilization of \textit{GPGPU} has brought forth the need of more extensive debugging-possibilities involving access of data that may be hard to retrieve from graphics cards - possibly due to architectural differences in-between chip manufacturers. A preferred solution to this problem has been to emulate such \textit{GPU}-kernels on the \textit{CPU} - in exchange for a substantial performance-loss. This study comprises an investigation into the performance of software emulation of hardware accelerated \textit{GPU}-kernels, by the means of analyzing several software rasterizers.\\
Furthermore, this study concerns inquiry into the DirectCompute-framework on the Windows-platform, analyzing the performance of a \textit{GPGPU}-kernel on-chip, using the DirectX standard software rasterizer, and utilizing the DirectX 11.1-addition\footnote{Bundled with Windows 8.} Microsoft \textit{WARP}-technology (Windows Advanced Rasterization Platform) - which promises high-speed software emulation in exchange for some computational precision. \\
A logical next step of such an evaluation would be to investigate any influence Microsoft WARP may have on computational precision. Thus, it is important that the result such a kernel would produce is measurable and deterministic. \\
\\
This study concludes that the performance loss of emulated \textit{GPGPU}-kernel may be considered negligible in exchange for possible extended possibilities of data extraction and increased granularity. As such, Microsoft \textit{WARP}-technology may be considered feasible for use in industry rasterization\footnote{Such a use-case might be if hardware is unavailable, not suffiecient or busy - as suggested by Microsoft. Link to Microsofts page on WARP here!}.\\
\\
% Outline and Conclusion
%	Vilket upplägg har resterande delar av matrialet?
As such, the study concerns the fields of simulation, emulation and \textit{GPU}-technologies - respectively, with the purpose of facilitating debugging and profiling of \textit{GPU}-kernels, whilst maintaining acceptable performance.

% CONTRIBUTION
\section{Contribution}
\label{sec:contribution}

% CONTRIBUTION - METHOD
\subsection{Method}
\label{sec:contribution:method}
% Introduction
%	Vilka principer, modeller, metoder och teknologier omfattar studiens design?
The experiment performed includes a DirectCompute \textit{GPGPU}-kernel consisting of a large matrix-multiplication which is calculated, in it’s entirety, in aforementioned kernel. The motivation behind such a task is that the result is easily verified as correct, and the precision of such an operation can be tested with different data-types - with regard to the effect Microsoft~\textit{WARP} may have on computational precision.\\
The test-cases investigated may be summarized as follows:
% Describe these modes and what they entail:
\begin{description*}
\item[Hardware-Acceleration:] \hfill \\
	The execution of a DirectCompute-kernel on a graphics card. Thus, this case will act as a reference for the remaining experiments.\\
	Expected high performance.
\item[Windows~Advanced~Rasterization~Platform~(\textit{WARP}):] \hfill \\
	The emulated execution of a DirectCompute-kernel using a special software rasterizer devised by Microsoft in their latest revision of the DirectX-framework.\\	
	Expectations unclear, but expected to perform better than standard software rasterization.
\item[Software~Rasterization~(DirectX~Reference~Device):] \hfill \\
	The emulated execution of a DirectCompute-kernel using a software rasterizer.\\
	Expected poor performance.
\end{description*}
In addition to these scenarios, the performance of several kernels with varying lavel of optimization have been examined. These entail the following:
\begin{enumerate*}
	\item Basic un-optimized kernel.
	\item \ldots
\end{enumerate*}
% Un-optimized basic kernel.
% Tiled kernel basic kernel.
% Tiled kernel utilizing shared memory.
% Tiled kernel utilizing shared memory with memory coalescing.
Furthermore, all test-cases have been performed with both integer- and floating-point precision\footnote{Not yet!}. As such, the experiment has been devised of the following approximate steps for each scenario:
\begin{enumerate*}
	\item Randomize two matrices \textbf{A} \& \textbf{B} using the specified data-type. These matrices will be the subjects of the experiment.
	\item Establish the product-matrix \textbf{Ref} of the two matrices. The resulting matrix will be used as a reference matrix to verify the final result.
	\item Start a synchronized high-precision timer.
	\item Dispatch the DirectCompute-kernel calculating the product matrix \textbf{A}\textbf{B}=\textbf{C}
	\item Stop the timer once the DirectCompute-kernel has finished.
	\item Assure that the resulting matrix is correct by comparing \textbf{C} to the previously established reference-matrix \textbf{Ref}.
\end{enumerate*}

% CONTRIBUTION - TECHNOLOGIES
\subsection{Technologies}
\label{sec:contribution:technologies}
The experiment was subdivided into two major components, both of which use Microsoft~Visual~Studio~2012 for compilation. These are presented below.

\subsubsection*{matrixgen}
The first, \textit{matrixgen},  was a utility developed to generate matrices of different dimensions and data-types. Furthermore, \textit{matrixgen} compiles the reference matrix \textbf{Ref} used when verifying the result returned from DirectCompute. \\
\textit{matrixgen} is written in \texttt{C++} and utilizes \texttt{C++~AMP} to generate and multiply matrices \textbf{A} \& \textbf{B} into product matrix \textbf{Ref}. In order to achieve random values in a \texttt{C++~AMP}-kernel the solution includes the random number generator-library \texttt{C++~AMP~RNG}.

\subsubsection*{experiment}
The second, \textit{experiment}, uses DirectCompute from the Microsoft~DirectX-framwork to compile the product matrix \textbf{C} from the matrices generated by \textit{matrixgen}. \textit{experiment} is written in \texttt{C++} with its respective DirectCompute-kernels written in \texttt{HLSL}. As \textit{experiment} is developed using the Windows~8 SDK, Windows~8 is required to run the application. \\
\\
In order to ease the experimental process, a script was developed to run both \textit{matrixgen} and \textit{experiment} consecutively a number of times with the desired configurations. This script, written in \texttt{Python}, then collect and present the results. \\
\\
The source code used during this study is freely available on \textit{GitHub}\footnote{Link here!}, along with a guide on how to compile and run the solution.

\subsubsection*{Equipment}
The experiment has been performed on a system with the following specifications:
\begin{description*}
	\item[CPU] \hfill \\
		Intel Q9550 Quad Core 2.83GHz
	\item[GPU] \hfill \\
		ATI Radeon HD 5800
	\item[OS] \hfill \\
		Windows 8.0
\end{description*}

% CONTRIBUTION - RESULTS
\subsection{Results}
\label{sec:contribution:results}
Preliminary results indicate a surprisingly well-performing WARP, roughly only doubling the execution time in regards to the same kernel hardware accelerated. Each configuration has been has been run using the same integer-precision 200x200-matrix. To gather the results presented below, each scenario has been run 100 times each. Please observe that these are preliminary tests, and more data is to be gathered before the closing of this article. \\
The results gathered during preliminary testing are presented below:
\begin{center}
	\begin{tabular}{| l | l | l | l |}
	\hline
	Acceleration & Min (ms) & Max (ms) & Average (ms)	\\ \hline
	Hardware & 25.86  & 43.12  & 26.41			\\ \hline
	Software & 16141.6 & 16906.7 & 16390.6		\\ \hline
	WARP & 46.18 & 64.25 & 48.47				\\
	\hline
	\end{tabular}
\end{center}

% Contribution
%	Vilka empiriska resultat erhölls vid experimentdesignens implementation?
% Conclusion
% ...for each segment brought up under Contribution.

% CONCLUSION
\section{Conclusion}
\label{sec:conclusion}
Conclusion left out in regards to further development and analysis.
% Summary
%	Vilken bakgrund, utmaning, ansats och resultat omfattar studien?
% Discussion
%	Vilka relaterade studier förhåller sig materialet till?
%	Vilka tvetydliga aspekter av studien kräver diskussion?
% Answer and Oppertunity
%	Vilka fortsatta studier föreslår rapportens författare?

% CONCLUSION - FUTURE WORK
\subsection{Future~Work}
\label{sec:conclusion:futurework}

% ACKNOWLEDGMENTS
\section*{Acknowledgments} % The \section*{} command stops section numbering
\addcontentsline{toc}{section}{\hspace*{-\tocsep}Acknowledgments} % Adds this section to the table of contents with negative horizontal space equal to the indent for the numbered sections
\label{sec:acknowledgments}
I wish to express my gratitude to my fellow students, colleagues and close friends Bob, Benny and no-one for their work, co-operation and positive attitude throughout the execution of this experiment.

\bibliographystyle{IEEEtranS}
\bibliography{doc}
\end{document}

% To-be-inserted references and/or footnotes:
% Microsoft Warp: http://msdn.microsoft.com/en-us/library/windows/desktop/gg615082%28v=vs.85%29.aspx